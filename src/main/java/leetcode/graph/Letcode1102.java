package leetcode.graph;

import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.PriorityQueue;
import java.util.Set;

public class Letcode1102 {
  public int maximumMinimumPath(int[][] A) {
    PriorityQueue queue = new PriorityQueue();
    int[] dirX = new int[]{1, -1, 0, 0};
    int[] dirY = new int[]{0, 0, 1, -1};
    Set<String> itemSet = new HashSet<>();
    queue.add(new QueueItem(0, 0, A[0][0]));
    itemSet.add("0_0");
    int xLen = A.length;
    int yLen = A[0].length;
//    queue.add(new QueueItem(xLen - 1, yLen - 1, A[xLen - 1][yLen - 1]));
    int score = A[0][0];

    while (!queue.isEmpty()) {
      QueueItem item = (QueueItem) queue.poll();
      int preX = item.x;
      int preY = item.y;

      score = item.score;

      if (preX == xLen - 1 && preY == yLen - 1) {
        return score;
      }
      for (int k = 0; k < 4; k++) {
        int x = preX + dirX[k];
        int y = preY + dirY[k];
        String content = String.valueOf(x) + "_" + String.valueOf(y);
        if (x >= 0 && x < xLen && y >= 0 & y < yLen & !itemSet.contains(content)) {
          itemSet.add(content);
          queue.add(new QueueItem(x, y, Math.min(score, A[x][y])));
        }
      }


    }

    return score;
  }

  public int maximumMinimumPathUnionSet(int[][] A) {

    int R = A.length;
    int C = A[0].length;
    int n = R * C;
    UnionSet d = new UnionSet(n);
    Set<String> s = new HashSet<>();
    List<QueueItem> lstLocal = new ArrayList<>();
    for (int i = 0; i < R; i++) {
      for (int j = 0; j < C; j++) {
        lstLocal.add(new QueueItem(i, j, A[i][j]));
      }
    }
    Collections.sort(lstLocal);


    int ans = Math.min(A[0][0], A[R - 1][C - 1]);
    s.add("0_0");
    s.add(String.valueOf(R - 1) + "_" + String.valueOf(C - 1));

    int[] dirX = new int[]{0, 0, 1, -1};
    int[] dirY = new int[]{1, -1, 0, 0};
    while (d.find(0) != d.find(n - 1) && !lstLocal.isEmpty()) {
      QueueItem item = lstLocal.get(0);
      lstLocal.remove(0);
      ans = Math.min(ans, item.score);

      for (int k = 0; k < 4; k++) {
        int x = item.x + dirX[k];
        int y = item.y + dirY[k];
        String content = x + "_" + y;
        if (x >= 0 && x < R && y >= 0 && y < C && s.contains(content)) {
          d.union(item.x * C + item.y, x * C + y);
        }
      }
      s.add(item.x + "_" + item.y);

    }

    return ans;


  }

  public static void main(String[] args) {
    long currentTime=System.currentTimeMillis();
    int[][] scoreArr = new int[][]{{499,901,68,810,68,652,179,120,942,62,594,898,598,713,647,987,495,4,382,772,391,7,453,355,984,745,106,578,752,878,839,629,272,834,527,373,743,619,511,999,263,556,211,526,316,243,288,954,133,301,614,551,482,161,898,438,294,119,199,257,764,48,997,540,259,190,442,25,32,631,961,667,867,945,541,849,130,619,127,389,506,9,829,573,285,938,435,166,741,318,64,372,636,47,75,133,227,757,609,886},{55,331,607,446,393,690,834,537,619,915,573,379,591,48,765,361,476,236,905,993,234,906,478,107,194,579,222,252,206,393,669,130,854,989,261,947,668,218,946,891,789,919,993,422,356,69,872,396,426,911,975,684,85,52,649,851,847,510,213,207,117,326,272,456,314,145,265,63,413,697,19,877,271,206,550,215,471,25,90,608,529,827,565,238,703,832,521,89,74,789,263,31,940,673,442,607,166,344,564,317},{877,839,274,521,219,455,767,918,37,436,175,646,764,241,281,965,496,776,759,617,214,460,240,107,443,268,242,440,519,29,56,954,631,254,896,232,685,989,222,887,804,667,697,486,499,417,943,232,703,254,714,789,300,173,408,500,534,99,830,684,688,655,822,5,562,978,649,95,962,524,511,645,137,912,825,141,348,429,484,726,248,484,0,85,410,871,751,612,746,749,55,574,700,662,101,535,287,432,324,990},{19,637,871,266,587,983,331,911,86,343,489,814,345,194,123,576,578,95,480,996,113,472,486,97,100,654,567,884,586,710,40,751,171,220,779,840,463,153,759,334,949,723,129,977,219,730,376,534,760,753,906,59,162,224,918,46,627,292,926,646,119,178,237,299,936,873,159,755,24,944,427,191,541,18,102,955,620,508,903,906,741,240,584,54,225,33,97,27,546,680,349,56,282,970,176,712,862,199,601,534},{116,106,665,849,614,689,231,535,395,147,551,37,533,520,171,229,422,638,172,657,177,708,813,388,251,664,140,252,392,87,160,827,623,202,221,877,997,327,260,886,694,831,469,631,677,164,922,723,572,329,817,699,503,338,378,660,269,176,587,874,100,71,311,379,559,965,178,216,155,17,5,177,927,167,773,806,73,121,997,829,688,866,413,854,177,674,480,53,751,71,409,555,452,495,597,835,401,381,969,654},{258,408,878,277,575,131,242,553,108,375,340,593,576,274,492,198,601,1000,845,205,420,532,331,250,254,881,307,314,530,964,706,137,871,344,251,314,785,410,18,105,117,565,593,171,311,22,53,768,855,989,756,473,402,588,818,431,521,630,651,511,894,805,227,576,441,600,714,36,386,589,482,926,844,883,670,670,994,968,598,847,579,777,285,859,602,741,372,660,312,515,950,300,224,345,76,941,782,716,414,973},{48,464,796,311,39,135,984,612,114,29,196,972,248,56,729,888,878,193,196,642,919,147,282,176,973,408,91,721,628,252,308,675,281,928,301,787,252,547,750,641,512,115,825,376,715,181,270,45,35,379,163,752,770,48,166,321,854,25,838,698,831,724,821,472,29,599,155,531,423,675,648,211,413,802,836,228,693,252,263,872,362,585,744,425,173,455,702,576,822,546,6,302,79,553,874,170,205,492,674,806},{226,104,742,216,218,631,645,537,967,890,178,733,707,181,593,28,178,272,989,287,846,916,129,583,640,149,893,88,920,63,753,849,99,327,934,250,735,708,519,965,310,737,590,166,777,18,900,28,368,627,221,32,921,874,828,823,289,78,981,598,98,147,781,157,395,138,180,805,601,288,39,28,162,832,131,22,168,389,763,833,281,202,347,15,745,23,308,875,669,942,16,684,638,408,877,463,751,677,360,457},{16,866,578,590,971,188,384,962,358,377,398,278,654,885,855,550,995,199,439,418,170,509,288,927,640,292,495,650,763,878,421,120,966,472,142,298,267,727,230,320,194,924,775,88,246,429,627,721,265,446,83,252,406,494,352,808,445,436,465,44,168,980,505,548,347,323,722,564,881,964,636,254,787,569,173,106,48,856,524,740,780,731,941,505,811,780,894,197,355,233,312,6,117,152,163,306,198,143,635,247},{926,582,887,53,808,581,13,605,572,386,398,566,26,545,722,848,257,10,611,101,61,639,544,777,162,563,675,311,833,804,652,938,813,161,999,628,242,433,911,574,63,456,684,237,569,510,425,157,736,102,694,234,776,652,356,460,312,66,827,815,108,784,443,56,92,296,828,833,712,691,915,362,518,493,901,502,671,269,559,369,293,146,721,949,566,856,348,308,229,337,432,502,3,595,154,347,97,114,737,450},{54,181,312,498,547,516,500,337,474,96,498,997,895,793,585,957,348,191,869,933,971,608,507,450,921,827,978,602,636,817,530,36,552,767,431,519,19,273,259,280,307,307,23,564,512,629,484,763,111,292,792,336,352,892,769,623,497,622,451,852,808,235,91,720,497,970,519,115,412,757,404,700,636,143,228,772,869,937,837,304,264,102,510,188,171,396,606,152,423,991,677,300,155,774,235,632,339,216,744,656},{52,105,561,712,499,227,601,277,10,510,825,6,266,374,63,770,993,22,889,159,221,158,145,534,397,188,506,614,297,107,254,16,446,630,958,918,953,673,639,96,182,528,408,574,553,246,594,723,0,298,517,126,164,578,101,144,876,207,875,601,842,380,339,644,871,473,228,569,101,714,149,929,214,285,665,69,110,17,194,523,413,1000,498,809,719,645,364,922,262,743,466,22,590,966,237,607,222,574,297,881},{394,730,767,821,876,178,951,106,186,700,116,774,804,368,105,108,577,53,501,39,687,465,344,143,900,383,928,69,95,361,251,248,135,701,925,254,387,45,605,835,953,485,231,817,85,24,539,264,399,229,679,480,985,168,607,682,658,924,878,796,897,756,20,586,890,834,449,741,738,799,235,598,658,804,144,28,490,281,454,99,571,474,538,124,278,62,537,969,425,919,442,801,929,485,608,421,969,656,132,610},{186,353,671,398,715,909,608,205,224,770,957,93,2,91,631,93,307,222,805,196,374,973,269,662,821,124,19,630,811,666,94,703,832,808,583,273,121,756,343,200,466,867,959,980,626,65,449,319,636,857,162,919,137,849,258,906,105,76,709,29,587,253,288,385,665,837,538,267,77,936,861,571,16,25,862,876,44,36,659,433,725,657,607,945,341,124,385,181,273,937,584,223,888,31,96,508,630,543,741,760},{66,239,308,76,725,989,232,814,975,535,894,779,941,356,215,229,449,734,516,129,682,837,103,627,127,601,590,740,339,755,334,647,309,322,332,515,897,401,907,891,627,386,116,596,302,365,316,364,576,590,923,519,921,925,312,811,596,627,752,620,653,123,441,966,551,700,923,845,715,49,577,437,667,12,585,847,718,911,576,857,821,446,602,209,203,513,119,801,437,691,111,532,698,938,831,504,514,314,171,700},{586,604,658,728,417,373,65,983,353,6,838,453,239,531,421,206,194,219,695,450,497,779,42,351,390,576,773,783,462,979,276,184,948,496,726,716,446,497,855,832,700,450,881,317,743,649,933,656,420,965,164,22,217,26,902,483,21,720,684,555,788,430,428,286,460,736,377,443,840,730,928,29,56,702,740,601,654,142,130,152,942,307,763,171,848,998,802,924,859,489,659,87,198,633,373,768,915,824,854,699},{797,283,755,858,882,196,336,95,387,365,948,225,321,447,964,187,899,16,844,135,742,513,366,25,171,826,750,910,305,325,317,264,371,592,794,634,405,903,793,382,572,873,789,737,598,769,460,547,62,777,480,789,62,107,957,216,411,399,489,270,148,435,675,712,83,303,707,701,886,466,481,504,216,566,658,240,40,461,466,705,639,598,764,821,911,997,196,748,248,292,171,787,459,932,651,136,424,148,545,626},{232,921,990,691,83,952,427,80,138,956,928,357,286,187,574,351,418,103,522,983,700,756,350,778,106,151,312,517,765,905,345,152,690,432,453,963,920,132,837,370,368,323,819,916,126,869,618,307,549,695,632,609,389,632,569,246,397,704,821,594,148,87,557,2,457,196,607,586,82,957,159,76,913,486,999,50,796,296,891,574,239,720,480,817,519,851,798,470,439,122,570,176,6,95,790,675,603,449,715,71},{403,79,517,613,313,707,223,896,602,460,873,635,872,257,922,595,795,301,835,604,955,303,663,989,586,173,552,226,437,372,457,443,831,314,796,590,360,923,243,658,927,615,746,516,444,101,645,365,194,571,557,594,984,808,149,180,859,298,974,658,345,98,904,563,388,118,679,346,392,91,559,217,281,813,453,195,886,217,140,239,164,911,419,536,787,637,987,403,339,312,343,980,948,197,831,346,979,398,306,387},{401,182,336,536,679,304,843,616,185,865,681,794,973,730,789,739,922,222,385,79,504,96,957,772,27,193,638,489,896,796,894,616,20,222,275,914,482,627,264,769,854,710,359,323,620,468,48,351,24,740,259,16,91,956,916,91,505,737,875,429,359,428,481,834,970,380,797,878,840,813,673,101,136,678,887,993,206,290,397,708,53,931,902,749,496,25,825,365,268,130,68,937,560,9,857,378,791,770,112,755},{346,304,322,9,277,904,421,802,56,154,859,578,868,128,930,957,283,867,618,41,743,585,916,409,398,226,431,730,39,636,193,937,674,811,216,219,939,538,706,475,308,6,115,899,782,477,203,476,968,505,226,82,642,272,976,386,787,246,68,924,689,571,824,58,306,430,318,200,870,471,221,783,524,654,440,387,995,885,423,978,633,618,454,81,480,131,943,970,390,594,860,864,348,647,245,212,442,338,434,650},{670,622,190,8,647,798,242,665,888,337,125,813,228,541,61,905,22,137,794,759,127,862,209,533,534,110,491,528,926,361,934,886,771,581,632,778,154,247,271,186,961,42,648,548,926,564,864,112,344,41,834,240,30,677,48,165,430,758,527,761,663,917,467,474,348,816,868,253,476,8,510,348,89,931,467,42,727,188,231,576,969,179,519,183,737,431,472,225,224,703,85,733,640,173,172,648,394,190,892,77},{310,948,83,301,737,579,131,512,696,277,992,944,233,64,442,297,241,239,61,361,49,375,615,374,554,227,388,473,210,123,391,600,697,244,156,382,571,405,435,124,672,829,36,824,398,609,337,283,388,907,926,24,739,73,41,30,707,1,839,153,27,642,559,407,865,751,809,903,494,467,312,817,351,359,258,920,674,863,77,328,388,276,706,804,114,584,889,682,857,896,389,703,665,218,629,116,795,708,526,338},{273,376,248,526,611,633,161,662,484,764,93,311,379,711,575,416,791,753,645,606,453,782,282,547,833,699,489,898,873,294,969,947,756,956,163,391,592,652,967,64,750,637,114,362,259,771,44,21,788,911,767,959,245,764,773,300,773,133,144,77,943,508,657,338,143,146,998,734,411,621,995,839,949,213,653,898,956,153,912,197,871,340,127,966,492,672,214,293,621,987,402,510,356,41,209,665,965,220,294,52},{851,414,514,159,521,312,944,634,918,227,827,217,234,664,919,517,641,607,297,547,63,348,261,482,367,445,688,563,734,503,976,905,983,763,449,634,695,675,987,927,694,22,634,755,927,360,229,930,914,510,342,331,535,845,42,350,463,870,119,298,708,957,788,4,278,735,551,441,941,982,446,139,162,373,858,457,433,13,791,845,609,272,436,219,206,353,467,916,947,133,229,632,184,954,35,81,739,578,915,210},{434,727,868,665,836,741,784,255,456,689,862,674,421,232,309,226,352,855,973,973,875,751,218,0,190,504,456,289,856,276,826,428,107,305,735,202,996,73,325,660,305,149,245,116,515,200,767,875,134,955,582,545,282,114,687,954,3,502,174,241,465,328,975,374,828,960,528,269,4,375,180,365,284,470,206,70,420,586,918,80,195,35,697,853,442,704,135,572,116,905,843,745,810,449,786,592,463,161,989,382},{125,699,334,866,518,137,856,542,449,930,396,516,490,959,139,997,440,33,663,653,812,104,933,385,272,467,225,456,781,871,687,940,936,234,273,278,591,230,610,842,231,689,623,537,551,201,730,962,681,331,913,601,713,858,85,200,773,454,371,433,662,483,19,117,923,134,504,222,398,70,572,39,741,800,131,990,255,919,570,517,804,312,353,150,350,91,517,950,336,683,945,591,2,814,478,836,838,774,895,711},{419,532,537,266,330,588,383,695,935,81,762,883,299,52,261,101,672,842,138,386,109,0,852,46,931,929,491,322,259,22,735,998,213,681,519,830,759,784,264,838,74,716,121,208,784,134,597,709,564,787,762,912,719,847,599,536,499,816,82,489,338,335,442,906,661,43,996,37,29,94,722,268,59,966,524,90,107,128,258,728,523,418,570,39,769,1000,60,177,89,970,194,689,847,166,399,448,203,845,989,447},{933,560,588,673,731,128,618,634,540,706,402,634,631,882,126,801,633,476,801,483,175,432,43,594,961,156,752,502,615,649,712,122,390,569,623,578,346,196,258,727,92,898,189,848,445,948,267,692,968,578,518,567,271,193,459,851,365,373,802,107,2,720,14,998,972,526,318,716,258,925,144,855,92,248,234,864,197,685,896,942,743,533,9,284,748,975,272,740,746,275,439,447,251,199,787,270,386,765,588,844},{584,686,72,38,6,291,554,455,562,595,505,259,978,237,716,478,911,390,622,901,676,493,930,468,513,751,880,304,29,704,260,395,510,864,53,918,798,416,182,486,595,618,270,129,54,722,529,233,74,439,736,850,705,78,869,802,162,240,844,947,528,791,502,126,922,395,656,193,6,466,375,894,163,459,342,67,423,584,45,560,532,200,213,617,778,278,908,76,257,784,335,371,981,723,577,743,307,601,277,253},{27,724,114,100,958,259,998,312,100,109,147,380,775,316,725,559,919,546,519,356,163,206,213,725,201,92,103,407,891,753,259,750,807,411,94,782,219,103,426,101,167,582,839,102,304,858,598,327,175,881,15,964,954,77,788,42,895,420,976,610,109,531,593,1,320,131,705,611,65,929,935,768,695,260,130,230,650,568,383,761,893,415,799,533,745,726,427,801,554,631,839,362,780,608,264,709,716,81,351,951},{674,293,118,412,605,173,974,177,193,98,290,369,79,621,309,437,381,58,419,761,731,808,80,994,255,563,441,749,96,998,973,674,796,973,542,987,499,76,165,595,720,36,137,692,262,710,529,925,844,683,944,4,12,964,569,624,806,158,455,789,446,565,780,523,850,80,843,786,572,332,736,893,879,619,826,740,273,746,699,823,111,600,794,559,201,706,628,459,565,153,292,750,320,1000,971,137,633,974,978,765},{659,235,898,721,517,510,846,353,163,641,342,212,648,183,715,625,959,412,188,160,461,665,198,801,874,294,310,464,119,144,765,986,915,739,44,846,118,352,194,658,826,161,748,978,457,704,950,653,230,604,98,703,447,727,432,826,955,174,142,867,342,314,183,620,107,917,210,783,594,168,88,82,697,560,160,343,963,701,201,753,298,677,572,742,472,744,189,827,818,173,269,55,649,718,591,177,456,614,22,859},{858,1,521,447,579,712,651,395,573,93,495,924,729,230,668,414,591,902,65,432,586,82,898,669,615,26,1,9,709,536,619,673,704,532,695,371,142,179,713,712,687,216,204,687,909,85,90,875,80,709,396,145,613,873,989,901,381,889,328,454,216,790,132,736,455,104,414,893,850,167,826,370,72,534,310,158,85,64,451,892,973,301,133,655,438,874,880,612,891,405,361,119,682,155,445,578,363,431,780,189},{454,822,823,816,374,450,667,665,413,466,505,905,163,962,470,155,849,432,286,557,748,704,94,474,282,732,232,108,759,225,302,874,158,719,41,87,240,600,823,938,391,118,397,431,815,714,292,87,467,70,520,383,323,661,325,480,999,355,758,664,581,609,172,38,56,676,286,157,397,361,137,393,462,425,416,245,78,889,256,633,43,230,934,62,141,949,372,835,639,811,973,382,593,415,114,634,89,884,581,301},{501,818,396,775,942,516,37,963,545,316,289,762,339,204,663,389,781,523,582,443,432,93,584,381,550,772,284,280,646,230,883,134,236,185,465,0,33,447,281,56,382,86,472,959,601,69,829,524,749,356,964,561,780,142,980,43,250,620,718,370,486,738,668,530,877,890,914,346,249,173,673,519,783,369,3,820,275,51,521,301,788,171,151,373,76,474,259,964,914,74,578,804,699,10,732,403,596,659,909,865},{845,183,165,858,706,408,120,278,393,839,78,158,691,292,485,34,401,143,70,720,518,408,578,422,978,429,970,119,647,493,760,521,155,34,71,557,317,144,877,723,130,168,550,434,408,807,143,575,402,386,955,789,734,117,674,266,415,35,807,619,647,898,883,49,465,298,983,611,301,30,626,239,229,114,610,888,812,703,289,784,162,497,904,774,133,0,942,95,248,939,814,796,725,375,905,344,734,792,24,32},{815,330,396,685,388,855,372,64,412,170,793,499,631,124,921,729,68,56,285,477,462,377,861,630,94,59,152,720,311,101,550,792,549,763,653,865,237,48,961,746,354,312,896,836,748,785,265,70,910,392,294,718,705,433,534,394,728,840,762,817,868,698,232,414,440,191,838,874,518,45,299,648,444,187,144,163,969,764,812,129,421,799,129,755,937,300,164,132,783,168,438,149,724,945,226,983,188,522,999,686},{418,628,833,124,331,154,990,635,125,489,331,835,382,694,32,815,296,46,34,900,855,696,390,607,777,280,97,548,430,664,347,597,38,968,394,360,91,352,683,747,154,517,842,688,411,942,82,93,972,57,135,905,563,548,889,325,180,607,496,887,521,468,857,746,645,939,868,25,217,678,868,755,228,654,517,479,32,459,603,213,96,118,597,239,592,673,143,848,96,852,617,960,55,349,258,212,757,602,114,319},{295,210,870,869,224,542,415,695,941,42,211,742,292,831,250,580,872,163,951,442,418,636,56,50,371,908,657,895,639,111,557,543,628,443,319,454,610,234,662,854,241,502,250,332,180,713,993,419,320,879,817,480,931,770,811,196,153,681,250,652,370,856,830,878,805,355,966,94,607,165,223,561,43,147,832,25,171,552,448,517,68,638,889,608,151,3,691,304,211,867,414,574,46,798,534,41,784,884,420,338},{466,341,304,898,262,660,399,492,957,480,438,901,11,761,958,543,263,72,654,570,146,167,651,885,317,754,406,432,214,832,265,665,603,739,820,297,10,627,986,899,363,601,673,419,698,892,530,123,150,873,938,714,387,144,308,176,782,713,206,736,130,946,94,738,435,27,709,2,972,583,480,147,756,535,489,178,516,845,479,395,550,467,449,581,583,115,953,941,627,541,429,377,310,908,292,261,538,178,475,789},{333,229,802,895,986,468,67,230,309,258,303,922,352,321,758,366,805,290,958,446,818,568,841,992,543,955,342,354,738,509,63,149,295,328,975,782,329,364,668,996,43,399,262,879,485,216,467,380,298,295,449,930,374,437,46,314,301,14,84,281,842,464,826,277,91,304,740,188,381,362,552,766,277,472,135,920,845,218,832,958,694,270,820,855,428,2,807,139,581,506,720,220,889,959,353,414,486,110,236,868},{940,541,932,528,671,340,19,10,938,634,943,150,830,663,938,4,634,491,81,593,68,54,812,916,702,872,357,268,747,666,359,786,684,476,937,555,833,717,914,182,76,142,939,96,433,400,847,742,998,225,504,298,398,73,945,477,775,86,886,826,413,346,788,437,41,496,928,302,522,630,952,317,75,610,272,535,327,661,497,48,417,935,726,617,457,118,7,366,804,874,651,128,896,517,656,979,918,624,544,902},{510,214,285,118,62,743,537,544,126,676,172,619,933,224,995,958,794,822,698,767,756,296,488,16,353,231,500,265,830,172,506,414,759,147,424,530,316,592,967,302,950,808,251,346,654,907,682,709,160,168,24,96,539,642,699,137,13,47,666,137,741,230,148,587,595,380,239,62,387,456,730,678,643,492,359,427,57,410,372,652,245,9,561,852,820,90,547,611,381,411,21,562,511,718,563,471,932,387,764,755},{298,994,802,450,649,192,791,568,379,592,215,883,725,372,648,969,267,523,657,666,868,189,652,57,285,699,205,554,512,55,694,682,800,572,109,162,765,8,101,34,320,26,913,749,684,458,736,105,209,247,384,828,926,964,215,682,588,939,512,244,459,436,31,904,881,257,241,506,878,150,478,914,278,639,415,166,547,712,291,145,2,84,919,12,436,252,792,374,489,583,82,826,916,641,829,722,792,432,682,477},{836,918,484,102,114,969,611,459,401,276,161,24,339,656,526,115,532,29,475,650,800,129,732,39,813,416,656,560,238,197,306,956,53,599,60,230,68,853,493,54,97,169,147,54,136,958,983,200,709,439,25,768,207,787,415,342,733,123,240,873,808,467,432,197,716,343,391,368,419,356,400,86,481,841,487,105,620,36,805,794,58,199,633,296,458,685,92,722,547,700,271,118,142,699,56,458,869,799,615,19},{303,509,209,328,780,469,98,39,193,629,652,199,655,701,768,894,703,364,657,49,105,662,967,34,162,343,225,751,108,53,541,364,627,224,946,406,949,970,253,890,319,930,839,41,545,249,498,981,570,46,756,191,967,543,208,22,282,92,908,632,633,20,722,59,658,825,380,726,357,907,854,122,627,267,399,603,595,997,795,602,701,744,131,56,777,506,25,597,422,894,252,442,951,389,669,698,111,337,432,892},{515,627,192,882,268,719,347,310,777,804,22,103,446,525,66,535,275,596,182,269,553,951,388,662,474,254,213,669,718,307,148,784,764,533,657,347,717,166,737,169,557,808,184,707,652,731,299,955,113,249,957,7,577,702,386,886,995,828,163,532,267,117,741,395,203,717,716,757,954,12,907,4,433,808,566,162,268,61,64,878,371,145,306,680,281,409,861,583,786,602,220,85,251,218,983,888,960,996,141,59},{660,55,988,525,847,390,142,92,799,554,300,918,200,672,462,716,600,430,24,991,358,61,356,771,303,986,585,874,421,204,32,927,880,763,395,208,622,27,579,802,46,389,717,45,355,894,18,263,970,600,68,231,11,770,610,588,240,849,448,108,159,722,300,943,865,921,475,30,388,892,792,774,57,686,738,86,32,516,87,380,271,978,299,870,92,324,931,954,359,683,561,864,44,708,971,143,948,384,380,600},{927,981,353,987,170,244,126,39,136,927,736,726,879,506,314,699,817,495,705,381,554,516,393,591,169,104,74,190,500,443,432,407,1,1,210,318,69,144,959,309,143,272,267,140,851,829,207,895,195,283,106,400,714,760,45,302,923,559,304,483,470,427,542,901,914,736,860,15,653,25,347,79,609,873,134,737,513,565,711,357,95,597,299,345,253,325,853,320,113,535,218,722,911,682,264,570,805,562,422,692},{475,822,222,322,547,602,422,991,736,605,309,917,105,285,134,818,167,304,125,716,210,521,675,357,477,142,674,809,721,236,121,237,950,41,328,162,192,759,937,612,564,236,525,870,418,819,573,151,176,121,157,870,543,690,381,347,745,678,223,591,739,436,273,779,606,304,980,46,525,817,601,804,576,397,699,97,704,650,367,822,343,292,745,645,836,561,115,675,508,782,664,230,246,399,242,708,737,746,629,527},{454,789,847,355,686,564,780,799,780,132,346,327,470,713,88,290,248,594,726,630,791,962,198,992,17,795,338,372,330,948,159,48,751,414,394,414,23,766,503,131,134,627,762,65,711,721,592,491,978,693,679,920,371,725,928,874,213,851,221,193,284,15,650,848,212,819,280,75,266,726,805,14,27,781,925,271,872,767,886,210,295,569,485,154,72,186,988,88,596,231,350,735,906,635,84,716,725,909,946,703},{22,305,679,972,677,536,461,831,371,587,447,538,291,536,157,346,960,209,302,90,379,233,848,411,943,407,226,501,896,30,956,916,724,10,653,926,128,12,824,897,971,443,187,851,189,662,116,871,836,352,470,257,288,628,480,371,480,821,988,981,968,522,47,355,592,712,682,220,783,792,377,119,738,189,654,89,255,278,945,266,525,211,636,49,395,147,231,166,82,987,857,704,442,244,899,587,212,89,287,338},{390,743,744,995,782,245,411,958,856,225,836,515,502,256,375,319,853,279,220,25,762,241,835,584,212,977,848,758,151,555,997,958,643,140,704,540,406,355,677,194,751,702,205,774,798,738,471,493,813,194,459,345,987,915,440,783,907,747,244,773,657,507,200,26,266,774,509,878,241,662,934,940,24,381,917,468,156,272,89,663,342,702,972,320,282,305,566,836,399,141,214,370,453,673,11,735,319,288,978,911},{717,138,285,801,971,150,945,177,734,528,186,319,733,992,296,453,397,124,198,626,509,239,488,399,445,944,54,539,14,424,977,618,164,78,616,631,529,384,451,373,380,578,556,246,174,559,764,879,220,751,286,975,325,213,927,193,888,408,515,46,144,138,817,837,951,216,188,992,909,88,490,53,343,335,196,731,233,248,157,822,270,749,559,3,809,718,816,488,986,853,42,887,233,331,823,46,984,714,860,63},{341,919,540,914,371,959,556,107,661,210,496,220,155,972,151,179,777,32,84,851,882,495,253,880,445,861,408,739,6,139,684,260,193,324,710,78,16,563,944,449,888,691,679,638,752,980,789,510,461,900,370,38,622,310,633,478,249,488,193,943,823,807,613,794,705,680,770,67,512,115,361,243,205,102,876,76,621,334,667,986,552,461,742,9,531,303,169,404,617,561,792,204,310,463,91,139,993,625,89,971},{908,392,590,526,581,313,767,819,751,79,395,860,774,184,530,952,219,908,449,971,216,456,492,418,989,608,791,208,714,944,849,946,632,506,310,211,964,627,293,273,504,986,251,941,552,363,853,208,699,218,889,688,974,470,319,396,27,485,36,513,646,138,241,649,896,637,906,54,1,480,221,902,63,734,635,2,868,671,938,175,42,167,354,541,815,111,927,569,175,369,953,247,684,247,34,104,921,369,898,193},{68,588,552,441,214,800,708,376,257,93,279,278,974,424,550,869,750,917,983,391,979,157,98,751,355,469,515,94,555,365,921,200,574,833,790,150,826,225,114,882,687,678,306,497,528,591,828,850,468,980,892,190,102,850,176,938,196,53,865,736,963,192,5,818,246,288,41,803,828,837,578,278,937,307,92,64,519,876,147,209,139,841,558,642,214,808,357,956,50,972,492,413,745,110,527,46,19,280,599,847},{621,669,743,278,94,72,202,862,734,652,905,234,876,620,690,720,423,698,894,229,52,6,915,266,699,806,143,173,681,712,796,945,899,620,604,615,13,278,236,606,944,294,521,79,353,305,31,243,116,48,540,163,632,482,864,358,960,866,538,256,476,236,383,727,77,363,746,30,177,450,77,554,321,285,676,540,404,801,721,30,388,607,367,59,480,928,817,466,588,773,3,117,670,193,740,989,954,628,844,71},{20,215,153,678,361,963,828,208,258,227,460,271,349,496,195,209,292,478,136,427,449,740,295,932,778,168,705,562,955,950,713,660,655,881,638,918,888,403,487,495,231,104,116,154,518,255,19,755,985,95,484,744,28,213,998,558,402,920,249,360,92,908,142,435,592,572,358,523,904,931,131,221,149,59,319,617,151,921,103,871,343,543,708,327,285,316,943,255,295,184,455,737,138,663,731,369,935,274,699,751},{868,785,578,628,706,516,829,335,979,636,210,427,330,189,942,255,566,806,520,787,361,522,166,118,53,19,181,947,41,967,984,649,276,693,109,975,91,196,113,167,574,134,167,568,505,144,892,371,474,17,672,491,650,800,770,153,215,229,829,460,486,873,699,559,168,681,710,756,402,365,440,914,674,240,630,349,521,610,407,263,448,257,375,449,119,749,626,627,374,944,814,360,460,325,353,120,788,897,569,552},{112,352,745,466,465,847,464,936,927,630,61,937,545,294,824,347,707,576,965,960,338,552,228,774,771,534,945,291,716,603,279,694,1000,172,96,169,91,629,972,292,145,940,307,198,136,85,84,207,479,179,561,936,787,660,136,623,580,721,532,553,250,760,631,357,93,461,267,91,153,321,167,653,354,348,356,670,440,666,988,988,764,492,256,481,321,38,428,131,657,710,303,885,32,628,31,466,256,151,739,186},{376,506,463,461,192,349,605,460,411,228,735,927,565,532,74,858,861,134,973,965,862,269,352,886,398,663,837,743,85,363,358,151,712,221,530,857,908,176,22,525,654,958,316,716,53,194,257,760,576,580,49,42,86,856,865,337,557,657,749,495,823,726,340,995,251,752,32,945,558,61,11,244,191,219,75,378,517,860,74,290,742,280,882,820,727,781,291,228,285,449,516,377,550,396,435,415,289,116,0,730},{388,516,781,864,414,532,432,229,187,877,437,782,27,775,179,27,56,395,602,277,275,24,295,749,758,409,99,54,386,159,80,667,513,666,964,368,505,221,156,177,234,971,574,181,824,923,318,497,654,715,191,389,97,121,970,144,180,702,76,346,608,418,325,813,532,22,913,248,360,850,94,141,290,552,848,667,37,495,866,488,489,507,640,259,180,972,139,7,985,146,161,58,199,88,676,924,927,829,492,433},{244,895,203,999,237,162,427,536,260,80,400,953,857,615,975,239,176,16,735,504,45,183,81,404,482,69,561,932,305,763,833,142,894,685,335,117,947,641,338,204,876,198,288,748,77,490,442,616,492,356,128,601,751,886,793,501,185,445,277,98,344,907,154,313,978,560,862,839,360,230,229,281,545,40,872,506,347,576,759,977,521,928,913,897,783,370,214,774,266,932,954,33,725,965,986,210,545,872,394,834},{797,274,645,310,355,247,450,816,704,382,693,737,282,976,422,545,870,768,724,220,884,575,960,341,746,763,299,159,839,767,768,19,868,704,414,847,246,965,703,715,558,476,683,111,131,707,244,844,783,886,151,165,641,685,627,879,817,989,275,36,912,192,746,320,543,515,34,376,388,842,165,940,397,107,578,803,504,687,773,794,666,417,615,37,75,122,516,766,81,80,385,13,704,493,267,199,669,527,882,30},{225,619,396,552,279,569,897,280,736,911,391,845,508,834,103,357,240,842,48,714,130,392,842,188,56,168,374,586,611,235,832,642,741,575,750,79,43,975,489,56,917,189,779,485,111,307,580,562,565,696,304,415,458,171,852,384,67,572,784,226,172,128,476,138,359,681,808,117,66,271,26,272,135,706,967,731,252,509,516,295,725,987,281,467,413,259,183,508,693,612,78,768,681,288,966,188,588,566,783,93},{980,42,531,27,775,12,91,489,528,151,821,441,81,590,101,248,907,804,311,501,734,766,521,689,374,952,910,906,361,177,500,164,988,933,638,641,567,446,444,363,266,9,696,786,879,100,449,214,476,969,894,51,146,210,741,246,26,435,245,771,300,290,56,280,35,920,158,694,171,934,564,703,165,386,837,356,956,150,809,313,289,991,941,190,738,476,829,753,355,962,905,807,552,190,923,57,354,412,722,603},{745,201,181,385,637,959,377,794,877,802,673,309,833,823,762,76,625,597,255,759,552,307,786,71,603,387,47,989,983,688,497,582,645,893,742,14,855,436,777,264,755,601,934,984,451,238,502,182,976,40,669,675,330,403,262,739,560,779,976,242,432,351,822,538,534,776,740,624,580,178,223,487,442,272,224,676,204,432,52,956,771,392,45,459,738,582,267,930,990,992,156,237,556,978,369,451,872,471,596,364},{648,347,155,329,722,444,182,298,780,165,438,6,611,398,219,72,931,16,645,472,287,656,518,147,408,377,162,236,378,958,509,608,334,55,879,985,118,622,89,407,345,837,845,953,660,680,327,224,528,825,117,420,602,543,926,21,538,693,331,951,470,223,357,314,885,555,576,475,794,709,208,696,864,654,92,375,155,970,815,292,990,868,807,982,6,91,887,386,266,469,864,392,32,728,405,115,730,255,655,631},{357,221,195,609,57,770,27,616,520,280,463,100,478,665,403,269,551,734,606,747,837,25,180,965,604,23,622,735,590,329,848,953,499,437,413,747,249,799,505,450,73,792,846,281,327,13,80,108,214,743,81,347,219,919,193,907,785,839,323,323,435,404,637,968,463,748,646,123,730,645,948,802,317,247,800,864,88,694,640,160,212,663,195,640,598,947,294,580,325,148,210,119,99,860,426,55,141,82,344,418},{876,246,867,575,976,876,684,719,552,311,997,28,999,273,461,850,716,144,113,52,549,122,433,6,152,204,259,7,483,746,539,292,258,440,247,729,721,367,254,222,641,759,574,741,564,106,703,533,947,73,730,953,457,593,852,917,926,583,910,135,717,405,506,470,720,747,247,408,389,475,444,169,177,533,49,542,470,288,675,369,530,301,436,959,730,184,576,590,854,36,822,198,640,601,231,450,674,989,578,817},{507,433,82,120,293,792,547,871,575,855,341,528,396,603,56,958,369,606,342,319,444,543,505,626,278,665,967,300,866,72,807,417,450,841,398,556,598,881,410,51,883,917,803,65,578,984,993,651,669,978,638,879,647,994,275,895,340,298,909,829,352,158,960,617,71,574,995,935,863,703,848,926,761,23,755,380,284,122,122,577,910,661,439,601,273,91,362,629,23,593,342,257,461,881,657,809,755,331,56,917},{542,979,424,78,636,606,971,649,315,691,657,364,144,75,316,189,207,8,164,123,238,702,315,505,859,305,635,286,468,576,159,300,681,411,709,219,327,605,130,121,306,785,586,608,172,259,671,666,972,332,210,351,61,771,393,673,387,608,818,77,695,79,623,917,813,595,394,262,805,575,742,890,808,400,623,868,68,797,123,247,772,824,736,810,495,641,82,868,960,94,757,983,865,981,421,307,199,188,220,809},{583,317,171,294,2,671,949,102,307,748,838,913,406,766,542,914,159,922,728,730,749,83,458,831,856,823,351,124,769,603,134,495,544,617,332,351,328,693,465,299,238,891,217,906,781,425,638,448,334,191,125,398,634,64,931,802,250,313,197,14,351,174,352,33,861,403,544,146,251,673,614,925,24,392,234,594,839,931,83,654,219,361,164,749,435,295,595,254,153,713,653,737,272,899,388,419,277,555,819,950},{460,801,796,445,158,549,401,685,11,720,804,296,299,545,53,4,282,306,323,533,907,242,199,702,351,770,299,317,526,909,880,123,461,739,398,93,648,77,982,209,147,753,56,766,146,410,309,762,181,260,855,878,160,509,932,42,538,585,946,923,952,175,877,1,314,425,394,455,529,654,659,358,478,404,1000,966,976,669,831,220,103,35,278,154,50,204,665,679,381,991,680,801,788,201,724,555,938,125,179,445},{7,321,103,413,805,212,368,120,912,517,481,676,52,402,273,816,983,251,313,677,259,336,855,57,120,317,897,934,268,163,388,530,566,325,494,43,546,333,380,838,561,113,811,650,494,53,783,949,861,32,301,835,62,997,261,843,886,100,553,3,218,305,744,952,400,674,325,430,102,951,821,715,886,886,172,264,136,701,557,813,172,760,626,605,193,756,292,859,756,126,522,597,771,891,810,369,169,593,393,204},{738,271,487,124,221,972,765,853,760,161,782,38,646,456,811,677,318,715,960,82,517,362,530,989,89,431,102,335,48,89,961,442,620,891,645,230,13,226,537,955,184,41,274,786,667,231,211,623,603,413,738,514,405,336,577,826,627,458,584,90,49,998,645,385,354,910,415,85,330,582,949,6,577,735,592,718,260,742,18,465,704,809,391,982,536,48,233,682,355,879,479,303,207,653,831,575,308,16,661,108},{951,11,766,531,694,591,254,953,774,532,208,243,141,63,31,385,15,639,457,505,685,398,862,566,263,772,497,781,586,350,502,587,79,803,70,512,363,797,426,18,357,902,982,830,915,613,800,3,673,592,242,689,359,459,87,186,510,125,897,664,614,111,666,737,323,729,357,166,731,102,593,721,404,442,965,91,193,830,734,299,889,404,940,145,296,234,11,359,912,1000,955,792,63,784,844,19,253,497,416,227},{731,585,171,766,480,390,810,536,686,98,174,240,15,839,353,813,605,339,485,711,811,161,344,885,812,623,714,501,484,7,941,918,554,363,861,245,756,260,672,749,724,264,714,817,182,734,45,943,565,282,821,312,781,608,54,838,122,894,931,395,811,831,932,43,206,600,205,528,547,191,275,241,1,387,428,175,877,354,694,791,423,756,788,333,53,732,597,973,614,347,571,160,405,381,520,632,601,112,120,931},{339,708,348,135,841,155,769,701,845,289,386,709,682,876,620,287,100,789,369,423,267,262,492,646,618,576,161,27,351,833,519,702,43,962,440,834,451,275,706,622,200,323,82,663,357,810,558,806,969,827,457,785,729,332,996,686,344,308,44,394,670,629,679,325,41,801,489,712,325,123,685,575,767,495,902,855,283,656,833,714,635,760,461,346,764,438,213,461,890,701,813,41,210,396,32,143,405,505,428,513},{398,431,263,830,384,989,445,690,868,305,612,506,934,483,543,613,409,374,453,684,426,226,936,854,549,391,63,60,480,604,142,612,567,136,35,792,198,574,672,9,32,637,412,335,408,705,315,239,476,893,576,433,999,939,115,530,428,680,720,314,822,831,606,948,309,228,512,525,5,201,218,942,686,658,640,461,330,61,798,523,844,813,728,11,843,908,715,138,86,710,615,189,224,613,682,874,660,158,141,561},{9,127,448,805,606,28,563,29,143,836,267,138,367,70,486,935,61,930,888,475,74,820,824,924,276,856,870,379,619,423,319,223,819,931,318,197,306,136,276,200,847,813,441,392,175,938,180,10,596,387,356,589,588,467,450,499,393,116,437,882,26,114,82,454,783,349,413,838,400,331,722,777,442,537,428,99,834,212,81,511,544,125,58,831,141,710,697,364,685,320,924,906,391,965,632,456,172,965,186,426},{790,760,359,824,522,471,961,216,715,998,274,677,851,632,230,37,604,617,811,170,268,610,633,555,490,440,784,767,739,784,869,825,789,455,915,698,409,166,207,668,11,786,851,471,879,255,206,74,753,408,773,194,316,770,566,459,370,470,817,17,679,627,974,965,889,252,635,933,540,163,792,353,533,330,19,745,139,902,473,778,181,697,184,795,605,3,561,756,748,148,226,704,814,722,402,122,655,380,939,292},{209,600,855,434,593,450,123,821,40,721,499,174,515,593,696,636,851,803,332,696,438,118,21,220,617,939,789,346,53,859,978,928,839,983,218,535,817,595,584,476,967,881,978,78,218,86,9,589,38,539,937,409,111,542,50,806,17,201,650,295,316,264,912,815,575,934,133,876,699,106,858,336,162,886,528,412,346,500,345,628,740,615,202,119,10,999,961,579,959,906,766,576,816,812,101,238,852,727,444,723},{348,929,717,631,666,314,318,842,825,20,516,423,626,515,633,920,613,8,512,628,831,111,314,487,339,938,906,146,646,216,557,982,183,207,948,474,725,996,572,18,503,241,775,897,926,312,949,598,487,925,506,216,307,450,574,624,859,706,822,852,61,854,939,621,62,558,833,21,475,253,403,582,607,536,723,833,698,586,766,851,428,65,377,868,834,720,651,751,108,58,230,188,695,53,866,60,26,727,238,143},{447,637,281,571,743,981,885,951,63,495,210,229,914,858,782,458,780,459,92,352,157,664,229,27,785,822,777,465,447,927,984,703,648,428,385,160,321,433,115,244,882,324,916,118,509,276,356,982,503,170,916,849,962,608,17,867,952,263,752,26,384,916,72,536,866,595,776,995,557,293,871,672,488,195,786,611,348,235,613,522,927,687,832,530,159,169,960,5,345,134,16,457,379,584,671,282,590,532,815,841},{234,728,798,153,772,537,625,723,964,31,310,152,571,383,309,270,414,491,670,375,101,764,596,267,134,992,443,408,655,833,25,23,316,288,385,586,87,902,148,180,588,562,659,445,4,189,819,617,439,225,866,766,69,532,38,962,668,68,643,507,743,559,455,235,408,297,680,431,296,102,449,505,71,27,912,768,769,867,541,169,328,322,119,40,267,412,120,18,129,32,17,980,140,878,53,275,800,762,719,978},{236,707,345,643,737,663,986,173,694,752,497,513,805,481,797,761,991,213,226,970,741,904,19,928,270,90,797,611,973,732,711,398,456,627,235,131,965,194,932,189,151,691,557,579,490,213,655,897,62,790,844,273,759,808,610,876,639,733,171,843,348,651,635,884,819,540,680,84,235,711,419,959,265,173,331,756,548,485,396,124,601,944,991,851,924,702,373,864,221,657,309,475,470,634,722,272,113,183,667,635},{168,758,488,584,224,545,4,447,952,902,124,946,229,593,578,115,590,666,327,844,665,583,639,634,685,990,20,351,502,682,505,960,138,670,168,752,517,915,749,362,924,909,474,323,790,255,857,398,429,599,472,587,520,499,684,606,299,100,915,499,317,685,296,260,971,470,515,368,880,7,496,490,232,53,974,527,100,336,109,986,945,982,446,797,533,349,260,718,393,224,166,881,411,248,979,97,403,408,879,689}};


    System.out.println(new Letcode1102().maximumMinimumPathUnionSet(scoreArr));
    long cost=System.currentTimeMillis()-currentTime;
    System.out.println("cost="+cost);
  }
}

class QueueItem implements Comparable<QueueItem> {
  public int compareTo(QueueItem o) {
    return (o.score - this.score);
  }

  public QueueItem(int x, int y, int score) {
    this.x = x;
    this.y = y;
    this.score = score;
  }

  public int x;
  public int y;
  public int score;

}


class UnionSet {
  int[] par = null;
  int[] sz = null;

  public UnionSet(int n) {
    par = new int[n];
    sz = new int[n];
    for (int i = 0; i < n; i++) {
      par[i] = i;
      sz[i] = 1;
    }


  }

  public int find(int x) {
    while (x != par[x]) {
      x = par[x];
    }
    return par[x];
  }

  public void union(int x, int y) {
    int xParent = find(x);
    int yParent = find(y);
    if (xParent == yParent) {
      return;
    }

    if (sz[xParent] < sz[yParent]) {
      int temp = xParent;
      xParent = yParent;
      yParent = temp;
    }
    par[yParent] = xParent;
    sz[xParent] += sz[yParent];
  }
}
